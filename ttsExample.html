<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ENTROPIA | DEEP SCAN HUD</title>
    <style>
        :root { --amber: #ffb300; --bg: #050505; --dim: #221a00; }
        body { background: var(--bg); color: var(--amber); font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .terminal { width: 650px; border: 2px solid var(--amber); padding: 25px; box-shadow: 0 0 20px rgba(255,179,0,0.3); background: rgba(0,0,0,0.9); }
        .header { border-bottom: 2px solid var(--amber); margin-bottom: 15px; display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2em; }
        
        /* THE DROPDOWN - STYLED FOR PROS */
        select { 
            width: 100%; background: #111; color: var(--amber); border: 1px solid var(--amber); 
            padding: 12px; font-family: inherit; font-size: 1.1em; cursor: pointer; outline: none;
        }
        select option { background: #000; padding: 10px; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        button { 
            background: rgba(255, 179, 0, 0.1); color: var(--amber); border: 1px solid var(--amber); 
            padding: 15px; cursor: pointer; text-transform: uppercase; font-weight: bold;
        }
        button:hover { background: var(--amber); color: #000; }
        
        .matrix { margin-top: 15px; font-size: 0.8em; border: 1px solid var(--dim); padding: 10px; }
        .stat { display: flex; justify-content: space-between; padding: 2px 0; }
        .val { color: #fff; text-shadow: 0 0 5px var(--amber); }
        #log { font-size: 0.7em; color: #665500; height: 45px; overflow-y: hidden; border-top: 1px solid var(--dim); margin-top: 10px; padding-top: 5px; }
    </style>
</head>
<body>

<div class="terminal">
    <div class="header">
        <span>[ DEEP_SCAN_ACTIVE ]</span>
        <span id="clock">00:00:00</span>
    </div>

    <label>SELECT HIGH-FIDELITY CHANNEL:</label>
    <select id="voice-select">
        <option>BOOTING SYSTEM...</option>
    </select>

    <div class="btn-grid">
        <button onclick="unlock()">Initialize Comms</button>
        <button onclick="speakMission()">Test Mission TTS</button>
    </div>

    <div class="matrix">
        <div class="stat"><span>UPLINKS DETECTED:</span> <span id="count" class="val">0</span></div>
        <div class="stat"><span>ARIA STATUS:</span> <span id="aria-stat" class="val">SEARCHING...</span></div>
        <div class="stat"><span>NEURAL ENGINE:</span> <span id="engine-stat" class="val">WAITING</span></div>
        <div id="log">> Initializing scan...</div>
    </div>
</div>

<script>
    const synth = window.speechSynthesis;
    const select = document.getElementById('voice-select');
    let voices = [];

    function updateClock() {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString();
    }
    setInterval(updateClock, 1000);

    function scanVoices() {
        voices = synth.getVoices();
        
        if (voices.length > 0) {
            // Sort them so the best ones (Aria, Natural, Google) are at the TOP
            voices.sort((a, b) => {
                const aName = a.name.toLowerCase();
                const bName = b.name.toLowerCase();
                if (aName.includes('aria')) return -1;
                if (aName.includes('natural')) return -1;
                if (aName.includes('google')) return -1;
                return 0;
            });

            const currentSelection = select.value;
            select.innerHTML = '';
            
            voices.forEach((v, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                // Add a "PRO" tag to high-quality online voices
                const tag = (v.name.includes('Online') || v.name.includes('Natural')) ? '[NEURAL]' : '[LOCAL]';
                opt.textContent = `${tag} ${v.name}`;
                select.appendChild(opt);
            });

            document.getElementById('count').innerText = voices.length;
            
            const aria = voices.find(v => v.name.includes("Aria"));
            const ariaStat = document.getElementById('aria-stat');
            if (aria) {
                ariaStat.innerText = "LOCKED ON";
                ariaStat.style.color = "#00ff00";
            } else {
                ariaStat.innerText = "NOT IN RANGE";
            }
        }
    }

    // THE BRUTE FORCE: Scan every 500ms until voices load
    const scanInterval = setInterval(() => {
        scanVoices();
        if (voices.length > 10) {
            document.getElementById('log').innerText = "> EXTENDED UPLINK ESTABLISHED.";
            document.getElementById('engine-stat').innerText = "HIGH-FIDELITY";
            // We stop the aggressive scan once we have a real list
            clearInterval(scanInterval);
        }
    }, 500);

    // Also trigger on the standard event
    synth.onvoiceschanged = scanVoices;

    function unlock() {
        const u = new SpeechSynthesisUtterance("Uplink successful. Aria standing by.");
        if (voices[select.value]) u.voice = voices[select.value];
        synth.speak(u);
        document.getElementById('log').innerText = "> COMMS CHANNEL OPEN.";
    }

    function speakMission() {
        const u = new SpeechSynthesisUtterance("Mission complete. Operation Ghost Protocol successful.");
        u.voice = voices[select.value];
        u.rate = 0.9;
        synth.cancel();
        synth.speak(u);
        document.getElementById('log').innerText = `> EXECUTING VIA: ${u.voice.name}`;
    }
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Colonists on Stream</title>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #1e1e1e;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    #header-row {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }

    #pagetitle {
      font-size: 3rem;
      color: #ffcc00;
      margin-bottom: 40px;
    }

    .nav-bar {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }

    button.button.nav.main {
	  height: 13vh;
      border: none;
      padding: 15px 20px;
      font-size: 1.5rem;
      border-radius: 10px;
      margin: 10px 0;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.3s;
      width: 80%;
      max-width: 400px;
    }

        .twitch-button {
            background-color: #9146FF; /* Twitch purple */
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .twitch-button:hover {
            background-color: #7a3fbd; /* Darker purple on hover */
        }

        #user-info {
            margin-top: 20px;
        }
  </style>
  <style type="text/css" id="operaUserStyle"></style>
  <link rel="stylesheet" href="data/cos-battle.css">
  <link rel="icon" type="image/png" href="../assets/images/logo/pixelbotfavicon.png">
</head>
<body>



	
	<div id="header-row" style="display: flex; flex-direction: row; justify-content: space-between; max-width: 98vw; flex-wrap: wrap;">
		<div id="pagetitle">Colonists on Stream</div>
		
		
			<!-- Twitch Stuff -->
		<!-- Add this to the /cos page -->
		<a href="https://id.twitch.tv/oauth2/authorize?client_id=YOUR_CLIENT_ID&redirect_uri=https://pixelb8.lol/cos&response_type=code&scope=user:read:email" class="twitch-button">Login with Twitch</a>
		<div id="user-info"></div>
		
		<!--End of Twitch Stuff -->
		
		
		<div class="nav-bar" style="height:100vh;">
			<button class="button nav main" onclick="location.href='cos-mobhunt.html'">Mob Hunt (alpha)</button>
			<button class="button nav main" onclick="location.href='cos-lurk/index.html'" style="opacity:0.3;" alt="in dev">Idle Game (coming soon)</button>
			<button class="button nav main" onclick="location.href='deathmatch.html'" style="opacity:0.3;" alt="coming soon">Deathmatch (coming soon)</button>
			<button class="button nav main" onclick="location.href='colonistroulette.html'">Colonist Roulette</button>
			<button class="button nav main" onclick="location.href='cos-leaderboards.html'" style="opacity:0.3;" alt="coming soon">Leaderboards</button>
		</div>
	</div>

</body></html>
    <script>
        // Function to extract query parameters from the URL
        function getQueryParam(param) {
            const params = new URLSearchParams(window.location.search);
            return params.get(param);
        }

        // Check if the URL has an authorization code
        const authCode = getQueryParam('code');
        
        if (authCode) {
            // Exchange the authorization code for an access token
            fetch('https://id.twitch.tv/oauth2/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    client_id: '1nvm719cyeb2ces4kjsf89bpcgsnah',
                    code: authCode,
                    grant_type: 'authorization_code',
                    redirect_uri: 'https://pixelb8.lol/cos'
                })
            })
            .then(response => response.json())
            .then(data => {
                const accessToken = data.access_token;
                console.log('Access Token:', accessToken);
                
                // Now fetch the user data using the access token
                fetchUserData(accessToken);
            })
            .catch(error => console.error('Error exchanging code for token:', error));
        }

        // Function to fetch user data from Twitch
        function fetchUserData(accessToken) {
            fetch('https://api.twitch.tv/helix/users', {
                headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Client-ID': '1nvm719cyeb2ces4kjsf89bpcgsnah'
                }
            })
            .then(response => response.json())
            .then(data => {
                const userData = data.data[0];
                const username = userData.display_name;
                const profilePicture = userData.profile_image_url;

                // Display the user info on the page
                document.getElementById('user-info').innerHTML = `
                    <h3>Welcome, ${username}</h3>
                    <img src="${profilePicture}" alt="Profile Picture" />
                `;
            })
            .catch(error => console.error('Error fetching user data:', error));
        }
    </script>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Secret Universal Services Transmission</title>
  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: 'Courier New', Courier, monospace;
      color: #00ffe6;
    }

    .transmission-ui {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      width: 600px;
      padding: 1.5rem;
      border: 2px solid #00ffe6;
      background: rgba(0, 0, 0, 0.65);
      text-align: center;
      opacity: 0;
      transition: opacity 1s ease-in;
      display: none;
    }

    .transmission-ui.visible {
      display: block;
      opacity: 1;
    }

    .header, .footer {
      font-size: 0.85rem;
      color: #ff003c;
      margin-bottom: 1rem;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .footer {
      margin-top: 1rem;
    }

    .terminal {
      font-size: 1.1rem;
      line-height: 1.8rem;
      letter-spacing: 1px;
      min-height: 100px;
      white-space: pre-wrap;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      margin: 10px 0 20px;
      overflow: hidden;
      position: relative;
    }

    .progress-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: -40%;
      width: 40%;
      height: 100%;
      background: #00ffe6;
      animation: loadBar 2s linear infinite;
    }

    @keyframes loadBar {
      0% { left: -40%; }
      50% { left: 100%; }
      100% { left: 100%; }
    }

    .popup-buttons {
      margin-top: 20px;
      display: none;
    }

    .popup-buttons button {
      font-size: 1rem;
      padding: 10px 20px;
      margin: 0 10px;
      color: #000;
      background: #00ffe6;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .popup-buttons button:hover {
      background: #ff003c;
      color: white;
    }
  </style>
</head>
<body>
  <div class="transmission-ui" id="transmissionUI">
    <div class="header">CLASSIFIED // EYES ONLY</div>
    <div class="progress-bar" id="statusBar"></div>
    <div class="terminal" id="terminalText">...</div>
    <div class="footer">SIGNAL MASKED â€” TRACE BLOCK ACTIVE</div>

    <div class="popup-buttons" id="popupButtons">
      <button id="yesButton">Yes, Play Audio</button>
      <button id="noButton">No, Skip</button>
    </div>
  </div>

  <script>
    const ui = document.getElementById("transmissionUI");
    const terminal = document.getElementById("terminalText");
    const popupButtons = document.getElementById("popupButtons");
    const yesButton = document.getElementById("yesButton");
    const noButton = document.getElementById("noButton");
    const statusBar = document.getElementById("statusBar");

    const sequence = [
      "Incoming Secure Transmission...",
      "Signal Lock Established.",
      "Decrypting Payload...",
      "Audio File Identified: [LEIA_CASSIDY.MP3]",
      "Transmission decrypted. Ready to play."
    ];

    const spokenMessage = `
	Begin Transmission.
	Subject: Leia Cassidy. Independent operator. No formal registry. Active near Fort Troy, beneath main radar array.
	Issuing combat contracts without clearance. Unknown backing. Sector logs show comm blackouts, signal drift, behavioral anomalies.
	Objective: Locate Cassidy. Establish contact. Accept contracts if secure. Assess alignment, threat level, and tactical value.
	Maintain recording. Uplink continuous. Disengage only if compromised.
	Status: Field recon and integration. Report all findings.

End Transmission.
    `;

    let i = 0;

    function showNextLine() {
      if (i < sequence.length) {
        terminal.textContent = sequence[i];

        if (i === 1) {
          statusBar.style.display = "none";
        }

        // After final line, show buttons
        if (i === sequence.length - 1) {
          popupButtons.style.display = "block";
        }

        i++;
        setTimeout(showNextLine, 1800);
      }
    }

    function speakMessage() {
      const synth = window.speechSynthesis;

      function speakNow() {
        const utterance = new SpeechSynthesisUtterance(spokenMessage);
        utterance.rate = 1.0;
        utterance.pitch = 1.0;
        utterance.voice = synth.getVoices().find(v =>
          v.name.includes("Daniel") || v.name.includes("Google UK") || v.default
        );
        synth.speak(utterance);
        terminal.textContent = "Playing mission audio...";
      }

      // If voices aren't loaded yet
      if (speechSynthesis.getVoices().length === 0) {
        speechSynthesis.onvoiceschanged = speakNow;
      } else {
        speakNow();
      }
    }

    yesButton.addEventListener("click", () => {
      popupButtons.style.display = "none";
      speakMessage();
    });

    noButton.addEventListener("click", () => {
      terminal.textContent = "Transmission skipped.";
      popupButtons.style.display = "none";
    });

    // Start on load
    window.onload = () => {
      setTimeout(() => {
        ui.classList.add("visible");
        showNextLine();
      }, 1000);
    };
  </script>
</body>
</html>
